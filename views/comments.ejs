<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body id="body-comments">

    <header id="headerComments">
        <h1>This isn't any normal discussion - it's "The Conversation"! </h1>
        <h3> Today's topic - what to do to rest after a week of coding an app like this ... </h3>
    </header>

    <a href="/logout"><span class="logout button">Logout</span></a>
    <br>

    <section>
        <form class="comments-Form" action="/comments/createComments" method='POST'>
            <textarea id="textBox" placeholder="Enter Comment" name='commentsItem'></textarea>
            <input class="button" type="submit">
        </form>

        <ul id="comments">

            <% let displaySet = 15 %>
            <% let currentItems = 0; %>
            <% comments.reverse() %>

            <%  const displayComments = function(x) { x.forEach ( el => { %>
                <li class='commentItem' data-id='<%=el._id%>'>
                    <div class="commentBody">
                        <p><%= el.comments %></p>
                        <div class="attribution">

                            <span class="userName"><%= el.userName %></span>
                            <span class="timestamp"><%= new Date(el.timeStamp * 1).toLocaleString() %></span>
                            <span class="likes"><%= el.likes %></span>
                        </div>
                    </div>
                    <% if (el.liked == false) { %> <span class='fa fa-thumbs-up like'>üëç</span><% } %>
                    <% if (currentUserId == el.userId) { %> <span class='del button'> Delete </span> <% } %>


                </li>

            <% })} %>

            <% const displayNext = () => {
                displayComments(comments.slice(currentItems, currentItems + displaySet));

                if (!(currentItems + displaySet > comments.length)) {
                    currentItems += displaySet;
                } else {
                    currentItems += (comments.length - currentItems)
                }
            } %>

            <% displayNext() %>
        
        
        </ul>
        
    </section>





    <script src="js/main.js"></script>

</body>

</html>